# JWT Configuration
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRY=900
JWT_REFRESH_TOKEN_EXPIRY=604800
JWT_SERVICE_TOKEN_EXPIRY=3600
JWT_ISSUER=caas.io
JWT_CLOCK_TOLERANCE_SECONDS=30
JWT_KEYS_DIRECTORY=./keys
JWT_PLATFORM_KEY_ID=platform-key-1
JWT_ENABLE_TENANT_KEYS=false

# Token Security
TOKEN_MAX_SIZE_BYTES=8192

# Refresh Token
REFRESH_TOKEN_ROTATION=true
REFRESH_TOKEN_REUSE_DETECTION=true
REFRESH_TOKEN_SLIDING_EXPIRATION=true

# Session Configuration
SESSION_TTL_SECONDS=86400
MAX_SESSIONS_PER_USER=10
SESSION_RENEWAL_COOLDOWN_MS=60000
SESSION_MAX_LIFETIME_SECONDS=604800
SESSION_CLEANUP_INTERVAL_MS=300000

# Session Security
SESSION_BINDING_LEVEL=DEVICE
CONCURRENT_SESSION_POLICY=LIMIT
ANOMALY_DETECTION_ENABLED=true

# TOTP Configuration
TOTP_ISSUER=CAAS
TOTP_ALGORITHM=SHA1
TOTP_DIGITS=6
TOTP_PERIOD=30
TOTP_WINDOW=1
TOTP_ENCRYPTION_KEY=change-this-in-production-min-32-chars

# Backup Codes
BACKUP_CODE_COUNT=10
BACKUP_CODE_LENGTH=8

# Trusted Devices
TRUST_TOKEN_EXPIRY_DAYS=30
MAX_TRUSTED_DEVICES=10

# MFA Challenge
MFA_CHALLENGE_TTL_SECONDS=300
MFA_MAX_ATTEMPTS=5
MFA_LOCKOUT_THRESHOLD=3

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=caas_redis_2026
REDIS_DB=0

# Kafka Configuration
KAFKA_BROKERS=kafka-1:9092,kafka-2:9093,kafka-3:9094
KAFKA_CLIENT_ID=auth-service
KAFKA_GROUP_ID=auth-service-group

# Logging
LOG_LEVEL=info
