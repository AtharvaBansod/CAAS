{
  "feature_group": "component-setup",
  "description": "UI component library setup and theming system",
  "tasks": [
    {
      "task-name": "Component Library Project Setup",
      "feature-details": "Initialize the UI component library package with React 18, TypeScript, Tailwind CSS, and build tooling. Configure Rollup for component bundling. Set up Storybook for component documentation and development.",
      "feature-dependency": [],
      "ai-prompt": "Create the @caas/ui component library package:\n\n1. packages/ui/package.json:\n   - name: @caas/ui\n   - main: dist/cjs/index.js\n   - module: dist/esm/index.js\n   - types: dist/types/index.d.ts\n   - peerDependencies: react@^18.0.0, react-dom@^18.0.0, @caas/sdk@^1.0.0, @caas/sdk-react@^1.0.0\n   - dependencies: tailwind-merge, clsx, framer-motion, @radix-ui/react-*\n   - devDependencies: @storybook/react-vite, typescript, rollup, tailwindcss\n\n2. tsconfig.json with React JSX, strict mode, declaration output\n\n3. tailwind.config.js:\n   - Custom theme extending default\n   - CSS variables for theming\n   - content: ['./src/**/*.{ts,tsx}']\n   - Prefix: 'caas-' to avoid conflicts\n\n4. rollup.config.js:\n   - External: react, react-dom, @caas/sdk, @caas/sdk-react\n   - Plugins: @rollup/plugin-typescript, postcss\n   - Preserve CSS imports\n   - Output ESM and CJS\n\n5. .storybook/main.ts:\n   - Vite-based Storybook 7\n   - TypeScript support\n   - Tailwind CSS addon\n   - Dark mode toggle\n\n6. .storybook/preview.ts:\n   - Global decorators\n   - Theme providers\n   - Mock SDK client\n\n7. src/index.ts exporting all components\n\n8. src/styles/globals.css with Tailwind imports and CSS variables",
      "testing-instructions": "1. Run 'npm run build' and verify output is generated\n2. Run 'npm run storybook' and verify Storybook starts\n3. Import a component and verify it renders\n4. Verify Tailwind classes are properly prefixed\n5. Check that CSS variables are defined\n6. Verify TypeScript declarations are generated\n7. Test that peerDependencies are not bundled",
      "acceptance_criteria": [
        "Package builds successfully",
        "Storybook runs and shows components",
        "Tailwind classes are properly prefixed",
        "CSS variables are available for theming",
        "TypeScript types are exported",
        "React and SDK are peer dependencies (not bundled)",
        "Package size is reasonable (<100KB gzipped)"
      ],
      "files_to_create": [
        "packages/ui/package.json",
        "packages/ui/tsconfig.json",
        "packages/ui/tailwind.config.js",
        "packages/ui/postcss.config.js",
        "packages/ui/rollup.config.js",
        "packages/ui/.storybook/main.ts",
        "packages/ui/.storybook/preview.ts",
        "packages/ui/src/index.ts",
        "packages/ui/src/styles/globals.css",
        "packages/ui/README.md"
      ],
      "docker_requirements": null,
      "task_id": "UI-001"
    },
    {
      "task-name": "Theming System",
      "feature-details": "Implement a comprehensive theming system with light/dark mode support, custom color schemes, and CSS variable-based customization. Provide ThemeProvider component and useTheme hook.",
      "feature-dependency": ["UI-001"],
      "ai-prompt": "Create the theming system in packages/ui/src/theme/:\n\n1. types.ts - Theme type definitions:\n   - Theme interface with colors, typography, spacing, radius\n   - ColorScheme type: 'light' | 'dark' | 'system'\n   - ThemeConfig for customization\n\n2. default-theme.ts:\n   - Light theme colors:\n     - primary: blue-600\n     - background: white\n     - foreground: gray-900\n     - muted: gray-100\n     - border: gray-200\n     - accent: blue-50\n   - Dark theme colors:\n     - primary: blue-500\n     - background: gray-900\n     - foreground: gray-50\n     - muted: gray-800\n     - border: gray-700\n     - accent: gray-800\n   - Typography scale\n   - Spacing scale\n   - Border radius scale\n\n3. ThemeProvider.tsx:\n   - Props: theme, colorScheme, children\n   - Detect system preference with matchMedia\n   - Listen for preference changes\n   - Set CSS variables on root element\n   - Context for theme access\n\n4. useTheme.ts hook:\n   - Returns: { theme, colorScheme, setColorScheme, isDark }\n   - Must be used within ThemeProvider\n\n5. createTheme.ts utility:\n   - createTheme(overrides: Partial<Theme>): Theme\n   - Deep merge with default theme\n\n6. css-variables.ts:\n   - Generate CSS variables from theme object\n   - Apply to DOM element\n\n7. Update globals.css with CSS variable definitions:\n   - :root { --caas-primary: ...; }\n   - .dark { --caas-primary: ...; }\n\n8. tailwind.config.js:\n   - Map Tailwind colors to CSS variables\n   - colors: { primary: 'var(--caas-primary)', ... }",
      "testing-instructions": "1. Test ThemeProvider with light theme renders correctly\n2. Test ThemeProvider with dark theme applies dark colors\n3. Test colorScheme='system' detects OS preference\n4. Test setColorScheme toggles between light/dark\n5. Test createTheme merges custom colors correctly\n6. Test CSS variables are applied to DOM\n7. Test useTheme throws outside provider\n8. Test preference change listener updates theme",
      "acceptance_criteria": [
        "Light and dark themes are defined",
        "ThemeProvider applies correct CSS variables",
        "System preference is detected automatically",
        "Color scheme can be changed dynamically",
        "Custom themes can be created with createTheme",
        "Tailwind classes use CSS variables",
        "Theme persists in localStorage",
        "No flash of incorrect theme on load"
      ],
      "files_to_create": [
        "packages/ui/src/theme/types.ts",
        "packages/ui/src/theme/default-theme.ts",
        "packages/ui/src/theme/ThemeProvider.tsx",
        "packages/ui/src/theme/useTheme.ts",
        "packages/ui/src/theme/createTheme.ts",
        "packages/ui/src/theme/css-variables.ts",
        "packages/ui/src/theme/index.ts"
      ],
      "docker_requirements": null,
      "task_id": "UI-002"
    },
    {
      "task-name": "Base UI Primitives",
      "feature-details": "Create foundational UI primitives using Radix UI that serve as building blocks for chat components. Includes Button, Input, ScrollArea, Tooltip, Dropdown, Dialog, and Avatar components.",
      "feature-dependency": ["UI-002"],
      "ai-prompt": "Create base UI primitives in packages/ui/src/components/primitives/:\n\n1. Button/Button.tsx:\n   - Variants: primary, secondary, ghost, danger\n   - Sizes: sm, md, lg\n   - States: loading, disabled\n   - Icon support: iconLeft, iconRight\n   - Full TypeScript props with ButtonHTMLAttributes\n   - Accessible focus states\n\n2. Input/Input.tsx:\n   - Variants: default, error, success\n   - Sizes: sm, md, lg\n   - Prefix/suffix slots\n   - Character count\n   - Error message display\n   - Based on Radix Form primitives\n\n3. ScrollArea/ScrollArea.tsx:\n   - Based on Radix ScrollArea\n   - Custom styled scrollbar\n   - Variants: visible, auto, hidden\n   - Horizontal and vertical scrolling\n   - onScrollEnd callback for infinite scroll\n\n4. Tooltip/Tooltip.tsx:\n   - Based on Radix Tooltip\n   - Props: content, side, align, delay\n   - Arrow indicator\n   - Dark background for contrast\n\n5. Dropdown/Dropdown.tsx:\n   - Based on Radix DropdownMenu\n   - DropdownItem, DropdownSeparator, DropdownLabel\n   - Keyboard navigation\n   - Sub-menus support\n\n6. Dialog/Dialog.tsx:\n   - Based on Radix Dialog\n   - DialogTitle, DialogDescription, DialogContent, DialogFooter\n   - Close button\n   - Modal backdrop\n   - Animation with Framer Motion\n\n7. Avatar/Avatar.tsx:\n   - Based on Radix Avatar\n   - Fallback to initials\n   - Status indicator slot\n   - Sizes: xs, sm, md, lg, xl\n   - Stacked avatar group\n\n8. Create Storybook stories for each primitive with:\n   - All variants\n   - Interactive controls\n   - Accessibility notes",
      "testing-instructions": "1. Test each component renders without errors\n2. Test Button variants apply correct styles\n3. Test Input error state shows error message\n4. Test ScrollArea fires onScrollEnd at bottom\n5. Test Tooltip appears on hover after delay\n6. Test Dropdown opens on click and closes on outside click\n7. Test Dialog traps focus when open\n8. Test Avatar fallback shows initials when image fails\n9. Verify all components are keyboard accessible\n10. Run Storybook and verify all stories render",
      "acceptance_criteria": [
        "All primitives render correctly",
        "Variants and sizes work as expected",
        "Keyboard navigation works for interactive components",
        "Focus states are visible and accessible",
        "Components are properly typed",
        "Storybook stories document all variants",
        "Components work with theme colors",
        "Animation is smooth (60fps)"
      ],
      "files_to_create": [
        "packages/ui/src/components/primitives/Button/Button.tsx",
        "packages/ui/src/components/primitives/Button/Button.stories.tsx",
        "packages/ui/src/components/primitives/Button/index.ts",
        "packages/ui/src/components/primitives/Input/Input.tsx",
        "packages/ui/src/components/primitives/Input/Input.stories.tsx",
        "packages/ui/src/components/primitives/Input/index.ts",
        "packages/ui/src/components/primitives/ScrollArea/ScrollArea.tsx",
        "packages/ui/src/components/primitives/ScrollArea/ScrollArea.stories.tsx",
        "packages/ui/src/components/primitives/ScrollArea/index.ts",
        "packages/ui/src/components/primitives/Tooltip/Tooltip.tsx",
        "packages/ui/src/components/primitives/Tooltip/Tooltip.stories.tsx",
        "packages/ui/src/components/primitives/Tooltip/index.ts",
        "packages/ui/src/components/primitives/Dropdown/Dropdown.tsx",
        "packages/ui/src/components/primitives/Dropdown/Dropdown.stories.tsx",
        "packages/ui/src/components/primitives/Dropdown/index.ts",
        "packages/ui/src/components/primitives/Dialog/Dialog.tsx",
        "packages/ui/src/components/primitives/Dialog/Dialog.stories.tsx",
        "packages/ui/src/components/primitives/Dialog/index.ts",
        "packages/ui/src/components/primitives/Avatar/Avatar.tsx",
        "packages/ui/src/components/primitives/Avatar/Avatar.stories.tsx",
        "packages/ui/src/components/primitives/Avatar/index.ts",
        "packages/ui/src/components/primitives/index.ts"
      ],
      "docker_requirements": null,
      "task_id": "UI-003"
    }
  ]
}
